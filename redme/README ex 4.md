# Node2Vec Implementation and Evaluation

This project implements and evaluates the **Node2Vec** algorithm for graph embedding using the **Cora** dataset. The primary objectives include:

1. Sampling **pq-walks** for nodes.
2. Implementing the Node2Vec embedding model and its training.
3. Evaluating the performance of the embeddings for:
   - **Node Classification**
   - **Link Prediction** (on both **Cora** and **PPI** datasets).

---

## Table of Contents
1. [Implementation Details](#implementation-details)
2. [Evaluation Results](#evaluation-results)
   - [Node Classification](#node-classification)
   - [Link Prediction](#link-prediction)
3. [Bonus Question: Stability of Predictions](#bonus-question-stability-of-predictions)
4. [Known Issues and Discussion](#known-issues-and-discussion)
5. [Future Improvements](#future-improvements)

---

## Implementation Details

### 1. PQ-Walks Dataset
We implemented a custom sampler using **torch_cluster**'s `random_walk` utility to generate **pq-walks**:
- **p (Return parameter)** and **q (In-out parameter)** control the biases of the walks.
- The walks are stored in a dataset for efficient batch processing during training.

### 2. Node2Vec Model and Training
The Node2Vec model:
- Uses a `torch.nn.Embedding` layer to learn embeddings for nodes in the graph.
- Optimized using **negative sampling loss**, combining positive and negative node pairs.

### 3. Node Classification
- Embeddings generated by Node2Vec are fed into a small **MLP classifier** for node classification.
- Classification performance is measured using accuracy on the **Cora** dataset.

### 4. Link Prediction
- For link prediction, embeddings of two nodes are combined using methods such as:
  - **Dot Product**
  - **Hadamard Product**
  - **Concatenation**
  - **Absolute Difference**
- Performance is evaluated using:
  - **ROC AUC (Receiver Operating Characteristic - Area Under Curve)**
  - **AP (Average Precision)**

---

## Evaluation Results

### Node Classification

| Metric         | Train Accuracy | Validation Accuracy | Test Accuracy |
|----------------|----------------|----------------------|---------------|
| **Accuracy**   | 100.0%         | 19.4%               | 18.4%         |

#### Classification Report (Test Set)
| Class | Precision | Recall | F1-Score | Support |
|-------|-----------|--------|----------|---------|
| 0     | 0.1517    | 0.2462 | 0.1877   | 130     |
| 1     | 0.1939    | 0.2088 | 0.2011   | 91      |
| 2     | 0.2111    | 0.1319 | 0.1624   | 144     |
| 3     | 0.3153    | 0.2006 | 0.2452   | 319     |
| 4     | 0.1397    | 0.1275 | 0.1333   | 149     |
| 5     | 0.1528    | 0.2136 | 0.1781   | 103     |
| 6     | 0.0763    | 0.1406 | 0.0989   | 64      |

The overall test accuracy was **18.4%**, significantly below the expected performance (60%+).

### Link Prediction (Cora)

#### Methods and Results

| Combination Method | ROC AUC | AP Score |
|--------------------|---------|----------|
| **Dot Product**    | 0.5856  | 0.5772   |
| **Hadamard Product** | 0.5000  | 0.5000   |
| **Concatenation**  | 0.7323  | 0.7113   |
| **Absolute Difference** | 0.7005  | 0.6911   |

#### Observations:
- **Concatenation** performed the best with a **ROC AUC of 0.7323** and an **AP score of 0.7113**.
- **Dot Product** and **Absolute Difference** also provided meaningful results.
- **Hadamard Product** failed to perform better than random guessing.

---

## Bonus Question: Stability of Predictions

The stability of predictions was not explicitly tested in this implementation. However, to evaluate stability:
1. Train the Node2Vec embeddings and classifier using different random seeds.
2. Measure the variance in test accuracy across different runs.


